generator client {
  provider = "prisma-client-js"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  // Why 254 in length? https://stackoverflow.com/a/1199238
  email     String   @unique @db.VarChar(254)
  // For reference, Github limits usersnames to 39 characteres.
  username  String   @unique @db.VarChar(39)
  // Why 60 in length? https://www.npmjs.com/package/bcrypt#hash-info
  password  String   @db.VarChar(60)
  // Why timestamp with timezone? https://justatheory.com/2012/04/postgres-use-timestamptz/
  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @default(now()) @updatedAt @db.Timestamptz()

  sessions Session[]

  @@map("users")
}

model Session {
  id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  token     String   @unique @db.VarChar(96)
  expiresAt DateTime @db.Timestamptz()
  createdAt DateTime @default(now()) @db.Timestamptz()
  updatedAt DateTime @default(now()) @updatedAt @db.Timestamptz()

  // Relationships
  userId String @db.Uuid
  user   User   @relation(fields: [userId], references: [id])

  @@map("sessions")
}
